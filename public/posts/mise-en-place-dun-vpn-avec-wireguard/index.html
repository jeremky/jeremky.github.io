<!DOCTYPE html>
<html lang="fr">
  <head>
    
      <title>
        Mise en place d&#39;un VPN avec Wireguard ::
        JeremKy.fr
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="Je ne vous présente pas ce qu&rsquo;est un VPN, Wikipedia fait ça très bien. Il existe plusieurs solutions pour héberger un VPN chez soi, le plus connu étant OpenVPN. Mais un petit nouveau a fait son apparition depuis quelques années. Il s&rsquo;agit de Wireguard. Ce dernier offre des performances dingues, que ce soit au niveau de la consommation des ressources ou des capacités de transfert.
Installation du serveur # Encore et toujours, je vous mets à disposition les fichiers compose que j&rsquo;utilise. L&rsquo;image utilisée est fournie par Linuxserver.io.
"
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://www.jeremky.fr/posts/mise-en-place-dun-vpn-avec-wireguard/" />







<link rel="stylesheet" href="/css/style.css" />

<link rel="stylesheet" href="https://www.jeremky.fr/style.css" />


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.jeremky.fr/img/apple-touch-icon-144-precomposed.png" />
<link rel="shortcut icon" href="https://www.jeremky.fr/img/favicon.png" />


<link href="/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Mise en place d&#39;un VPN avec Wireguard">
  <meta name="twitter:description" content="Je ne vous présente pas ce qu’est un VPN, Wikipedia fait ça très bien. Il existe plusieurs solutions pour héberger un VPN chez soi, le plus connu étant OpenVPN. Mais un petit nouveau a fait son apparition depuis quelques années. Il s’agit de Wireguard. Ce dernier offre des performances dingues, que ce soit au niveau de la consommation des ressources ou des capacités de transfert.
Installation du serveur # Encore et toujours, je vous mets à disposition les fichiers compose que j’utilise. L’image utilisée est fournie par Linuxserver.io.">



<meta property="og:url" content="https://www.jeremky.fr/posts/mise-en-place-dun-vpn-avec-wireguard/">
  <meta property="og:site_name" content="JeremKy.fr">
  <meta property="og:title" content="Mise en place d&#39;un VPN avec Wireguard">
  <meta property="og:description" content="Je ne vous présente pas ce qu’est un VPN, Wikipedia fait ça très bien. Il existe plusieurs solutions pour héberger un VPN chez soi, le plus connu étant OpenVPN. Mais un petit nouveau a fait son apparition depuis quelques années. Il s’agit de Wireguard. Ce dernier offre des performances dingues, que ce soit au niveau de la consommation des ressources ou des capacités de transfert.
Installation du serveur # Encore et toujours, je vous mets à disposition les fichiers compose que j’utilise. L’image utilisée est fournie par Linuxserver.io.">
  <meta property="og:locale" content="fr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-23T17:26:52+00:00">
    <meta property="article:modified_time" content="2024-06-23T17:26:52+00:00">
    <meta property="article:tag" content="Reseau">
    <meta property="article:tag" content="Docker">
    <meta property="article:tag" content="Podman">






  </head>
  <body >
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >JEREMKY.FR</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/apropos">A propos</a></li>
        
      
        
          <li><a href="/archives">Archives</a></li>
        
      
        
          <li><a href="/categories/news">News</a></li>
        
      
        
          <li><a href="/categories/tutos">Tutos</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/apropos">A propos</a></li>
      
    
      
        <li><a href="/archives">Archives</a></li>
      
    
      
        <li><a href="/categories/news">News</a></li>
      
    
      
        <li><a href="/categories/tutos">Tutos</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <article class="post">
    <h1 class="post-title">Mise en place d&rsquo;un VPN avec Wireguard</h1>
    <div class="post-meta">
      
        <time class="post-date">
          23/06/2024
        </time>

        
          
        
      

      


      
        <span class="post-read-time"
          >— 2 min de lecture</span
        >
      
    </div>

    
      <span class="post-tags">
        
          <a href="https://www.jeremky.fr/tags/reseau/">#reseau</a>&nbsp;
        
          <a href="https://www.jeremky.fr/tags/docker/">#docker</a>&nbsp;
        
          <a href="https://www.jeremky.fr/tags/podman/">#podman</a>&nbsp;
        
      </span>
    

    
      <figure class="post-cover">
  
    <img src="https://www.jeremky.fr/img/posts/mise-en-place-dun-vpn-avec-wireguard/cover.webp" alt="Mise en place d&#39;un VPN avec Wireguard" width="700" />
  

  
</figure>

    

    <div class="post-content">
      
        
        <h2>Sommaire</h2>
        <aside class="table-of-contents"><nav id="TableOfContents">
  <ul>
    <li><a href="#installation-du-serveur">Installation du serveur</a></li>
    <li><a href="#configuration-du-client">Configuration du client</a></li>
    <li><a href="#firewall-ufw">Firewall UFW</a></li>
    <li><a href="#port-nat">Port NAT</a></li>
  </ul>
</nav></aside>
        
      
      <p>Je ne vous présente pas ce qu&rsquo;est un VPN, <a href="https://fr.wikipedia.org/wiki/R%C3%A9seau_priv%C3%A9_virtuel">Wikipedia</a> fait ça très bien. Il existe plusieurs solutions pour héberger un VPN chez soi, le plus connu étant OpenVPN. Mais un petit nouveau a fait son apparition depuis quelques années. Il s&rsquo;agit de <a href="https://fr.wikipedia.org/wiki/WireGuard">Wireguard</a>. Ce dernier offre des performances dingues, que ce soit au niveau de la consommation des ressources ou des capacités de transfert.</p>
<h2 id="installation-du-serveur">
  Installation du serveur
  <a href="#installation-du-serveur" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>Encore et toujours, je vous mets à disposition les fichiers compose que j&rsquo;utilise. L&rsquo;image utilisée est fournie par <a href="https://www.linuxserver.io/">Linuxserver.io</a>.</p>
<p>Le fichier <code>docker-compose.yml</code> :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">wireguard</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">lscr.io/linuxserver/wireguard:latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">wireguard</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">hostname</span>: <span style="color:#ae81ff">wireguard</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">env_file</span>: <span style="color:#ae81ff">wireguard.env</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">cap_add</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">NET_ADMIN</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">/opt/wireguard:/config</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">/lib/modules:/lib/modules</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">51820</span>:<span style="color:#ae81ff">51820</span><span style="color:#ae81ff">/udp</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">sysctls</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">net.ipv4.conf.all.src_valid_mark=1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">restart</span>: <span style="color:#ae81ff">always</span>
</span></span></code></pre></div><p>Son fichier <code>wireguard.env</code> :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>PUID=1000
</span></span><span style="display:flex;"><span>PGID=1000
</span></span><span style="display:flex;"><span>TZ=Europe/Paris
</span></span><span style="display:flex;"><span>SERVERURL=foo.bar.com
</span></span><span style="display:flex;"><span>SERVERPORT=51820
</span></span><span style="display:flex;"><span>PEERS=client1,client2
</span></span><span style="display:flex;"><span>PEERDNS=1.1.1.2,1.0.0.2
</span></span><span style="display:flex;"><span>INTERNAL_SUBNET=10.13.13.0
</span></span><span style="display:flex;"><span>ALLOWEDIPS=0.0.0.0/0
</span></span></code></pre></div><p>Dans ce fichier, vous avez quelques éléments à modifier :</p>
<ul>
<li>La variable <code>SERVERURL</code> à remplacer par votre nom de domaine</li>
<li>La variable <code>PEERS</code>, qui contient la liste de vos clients VPN séparés par une virgule</li>
<li>La variable <code>PEERDNS</code>, où vous allez définir les serveurs DNS à utiliser (Cloudflare dans notre exemple)</li>
</ul>
<h2 id="configuration-du-client">
  Configuration du client
  <a href="#configuration-du-client" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>Pour l&rsquo;installation du client, vous pouvez vous rendre sur <a href="https://www.wireguard.com/install/">cette page</a>. Le client est disponible pour tous les systèmes d&rsquo;exploitation. Une fois installé, vous pouvez ajouter la configuration soit manuellement, soit en effectuant un scan d&rsquo;un QR code depuis vos appareils mobile. Il peut s&rsquo;afficher directement dans votre terminal :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker exec -it wireguard /app/show-peer client1
</span></span></code></pre></div>
  <img src="/img/posts/mise-en-place-dun-vpn-avec-wireguard/peer.webp"  class="center"  style="border-radius: 8px;"  />


<p>Je vous conseille d&rsquo;ajouter un alias dans votre fichier <code>.bash_aliases</code> pour plus de confort :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>alias peer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;docker exec -it wireguard /app/show-peer $1&#39;</span>
</span></span></code></pre></div><p>Si toutefois vous devez ajouter les infos manuellement, le fichier de configuration se trouve sur votre hôte dans un sous dossier de <code>/opt/wireguard</code>. Dans notre exemple : <code>/opt/wireguard/peer_client1/peer_client1.conf</code>
Une fois la configuration importée, vous pouvez activer votre VPN !</p>
<h2 id="firewall-ufw">
  Firewall UFW
  <a href="#firewall-ufw" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>Si vous souhaitez accéder à vos applications sur le même serveur où se trouve Wireguard et que vous avez ufw installé, vous constaterez que vos applications ne sont pas accessibles&hellip; Il est donc nécessaire, sur le host, d&rsquo;ajouter les ports à autoriser pour votre conteneur Wireguard. Par exemple, pour accéder à votre proxy web :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo ufw allow https
</span></span></code></pre></div><h2 id="port-nat">
  Port NAT
  <a href="#port-nat" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>Enfin, pour pouvoir accéder à votre VPN depuis Internet, vous devez ajouter une ouverture de port NAT sur votre box. Dans le cas de Wireguard, il faut ouvrir le port UDP 51820.</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Autres posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://www.jeremky.fr/posts/watchtower-un-conteneur-pour-les-gouverner-tous/">
                  <span class="button__icon">←</span>
                  <span class="button__text">Watchtower : un conteneur pour les gouverner tous</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="https://www.jeremky.fr/posts/ddclient-synchroniser-un-domaine-a-son-ip-automatiquement/">
                  <span class="button__text">ddclient : synchroniser un domaine à son IP automatiquement</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </article>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >JEREMKY.FR</span
    >
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
          <div class="copyright">
        <span>© 2025 Propulsé par <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span>
      </div>
    
  </div>
</footer>





<script type="text/javascript" src="/bundle.min.js"></script>


      
    </div>

    
  </body>
</html>
