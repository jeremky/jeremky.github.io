<!DOCTYPE html>
<html lang="fr">
  <head>
    
      <title>
        Réécriture des articles au sujet de Docker ::
        JeremKy.fr
      </title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta
  name="description"
  content="J&rsquo;ai récemment écrit un article au sujet de ma migration de Docker vers Podman. Les différences entre ces 2 solutions sont minimes, mais elles nécessitent 2 ou 3 ajustements au niveau des fichiers docker-compose.yml pour être 100% compatibles. C&rsquo;est donc l&rsquo;occasion de refaire un tour sur les différents articles de ce site qui concernent la mise en place d&rsquo;applications via un système de conteneurs.
Variables # J&rsquo;avais pris pour habitude d&rsquo;utiliser un maximum de variables pour les définitions de certains éléments dans le fichier docker-compose.yml. Cela pouvait concerner les ports d&rsquo;écoute, les chemins des volumes persistant&hellip; Mais à l&rsquo;usage, cela n&rsquo;a pas vraiment d&rsquo;intérêt, sachant qu&rsquo;en plaçant ces variables dans le fichier .env associé, elles se retrouvaient chargées dans le conteneur, ce qui ne fait pas vraiment sens. L&rsquo;idée était de pouvoir déployer plusieurs conteneurs ayant un fichier docker-compose.yml unique. Mais il suffit de dupliquer le dossier et c&rsquo;est réglé.
"
/>
<meta
  name="keywords"
  content=""
/>
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://www.jeremky.fr/posts/reecriture-des-articles-docker/" />







<link rel="stylesheet" href="/css/style.css" />

<link rel="stylesheet" href="https://www.jeremky.fr/style.css" />


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.jeremky.fr/img/apple-touch-icon-144-precomposed.png" />
<link rel="shortcut icon" href="https://www.jeremky.fr/img/favicon.png" />


<link href="/fonts/Inter-Italic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Regular.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Medium.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-MediumItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-Bold.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">
<link href="/fonts/Inter-BoldItalic.woff2" rel="preload" type="font/woff2" as="font" crossorigin="">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Réécriture des articles au sujet de Docker">
  <meta name="twitter:description" content="J’ai récemment écrit un article au sujet de ma migration de Docker vers Podman. Les différences entre ces 2 solutions sont minimes, mais elles nécessitent 2 ou 3 ajustements au niveau des fichiers docker-compose.yml pour être 100% compatibles. C’est donc l’occasion de refaire un tour sur les différents articles de ce site qui concernent la mise en place d’applications via un système de conteneurs.
Variables # J’avais pris pour habitude d’utiliser un maximum de variables pour les définitions de certains éléments dans le fichier docker-compose.yml. Cela pouvait concerner les ports d’écoute, les chemins des volumes persistant… Mais à l’usage, cela n’a pas vraiment d’intérêt, sachant qu’en plaçant ces variables dans le fichier .env associé, elles se retrouvaient chargées dans le conteneur, ce qui ne fait pas vraiment sens. L’idée était de pouvoir déployer plusieurs conteneurs ayant un fichier docker-compose.yml unique. Mais il suffit de dupliquer le dossier et c’est réglé.">



<meta property="og:url" content="https://www.jeremky.fr/posts/reecriture-des-articles-docker/">
  <meta property="og:site_name" content="JeremKy.fr">
  <meta property="og:title" content="Réécriture des articles au sujet de Docker">
  <meta property="og:description" content="J’ai récemment écrit un article au sujet de ma migration de Docker vers Podman. Les différences entre ces 2 solutions sont minimes, mais elles nécessitent 2 ou 3 ajustements au niveau des fichiers docker-compose.yml pour être 100% compatibles. C’est donc l’occasion de refaire un tour sur les différents articles de ce site qui concernent la mise en place d’applications via un système de conteneurs.
Variables # J’avais pris pour habitude d’utiliser un maximum de variables pour les définitions de certains éléments dans le fichier docker-compose.yml. Cela pouvait concerner les ports d’écoute, les chemins des volumes persistant… Mais à l’usage, cela n’a pas vraiment d’intérêt, sachant qu’en plaçant ces variables dans le fichier .env associé, elles se retrouvaient chargées dans le conteneur, ce qui ne fait pas vraiment sens. L’idée était de pouvoir déployer plusieurs conteneurs ayant un fichier docker-compose.yml unique. Mais il suffit de dupliquer le dossier et c’est réglé.">
  <meta property="og:locale" content="fr">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-10-07T10:38:36+02:00">
    <meta property="article:modified_time" content="2024-10-07T10:38:36+02:00">
    <meta property="article:tag" content="Infos">
    <meta property="article:tag" content="Docker">
    <meta property="article:tag" content="Podman">






  </head>
  <body >
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >JEREMKY.FR</span
    >
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/apropos">A propos</a></li>
        
      
        
          <li><a href="/archives">Archives</a></li>
        
      
        
          <li><a href="/categories/news">News</a></li>
        
      
        
          <li><a href="/categories/tutos">Tutos</a></li>
        
      
      
      
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/apropos">A propos</a></li>
      
    
      
        <li><a href="/archives">Archives</a></li>
      
    
      
        <li><a href="/categories/news">News</a></li>
      
    
      
        <li><a href="/categories/tutos">Tutos</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none" />
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg
  class="theme-toggler"
  width="24"
  height="24"
  viewBox="0 0 48 48"
  fill="none"
  xmlns="http://www.w3.org/2000/svg"
>
  <path
    d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"
  />
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <article class="post">
    <h1 class="post-title">Réécriture des articles au sujet de Docker</h1>
    <div class="post-meta">
      
        <time class="post-date">
          07/10/2024
        </time>

        
          
        
      

      


      
        <span class="post-read-time"
          >— 3 min de lecture</span
        >
      
    </div>

    
      <span class="post-tags">
        
          <a href="https://www.jeremky.fr/tags/infos/">#infos</a>&nbsp;
        
          <a href="https://www.jeremky.fr/tags/docker/">#docker</a>&nbsp;
        
          <a href="https://www.jeremky.fr/tags/podman/">#podman</a>&nbsp;
        
      </span>
    

    
      <figure class="post-cover">
  
    <img src="https://www.jeremky.fr/img/posts/reecriture-des-articles-docker/cover.webp" alt="Réécriture des articles au sujet de Docker" width="700" />
  

  
</figure>

    

    <div class="post-content">
      
      <p>J&rsquo;ai récemment écrit <a href="/posts/migration-de-docker-vers-podman/">un article</a> au sujet de ma migration de Docker vers Podman. Les différences entre ces 2 solutions sont minimes, mais elles nécessitent 2 ou 3 ajustements au niveau des fichiers <code>docker-compose.yml</code> pour être 100% compatibles. C&rsquo;est donc l&rsquo;occasion de refaire un tour sur les différents articles de ce site qui concernent la mise en place d&rsquo;applications via un système de conteneurs.</p>
<h2 id="variables">
  Variables
  <a href="#variables" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>J&rsquo;avais pris pour habitude d&rsquo;utiliser un maximum de variables pour les définitions de certains éléments dans le fichier <code>docker-compose.yml</code>. Cela pouvait concerner les ports d&rsquo;écoute, les chemins des volumes persistant&hellip; Mais à l&rsquo;usage, cela n&rsquo;a pas vraiment d&rsquo;intérêt, sachant qu&rsquo;en plaçant ces variables dans le fichier <code>.env</code> associé, elles se retrouvaient chargées dans le conteneur, ce qui ne fait pas vraiment sens. L&rsquo;idée était de pouvoir déployer plusieurs conteneurs ayant un fichier <code>docker-compose.yml</code> unique. Mais il suffit de dupliquer le dossier et c&rsquo;est réglé.</p>
<h2 id="fichiers-env">
  Fichiers .env
  <a href="#fichiers-env" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>L&rsquo;autre changement important, est dans l&rsquo;appel des variables d&rsquo;environnement utilisées par le conteneur lui même. Dans le cas où plusieurs conteneurs sont définis dans un seul fichier <code>docker-compose.yml</code>, ces variables étaient donc chargées dans tous les conteneurs. Et&hellip; En terme de sécurité, ce n&rsquo;est pas génial (un mot de passe de base de donnée pouvait être chargé dans le front web par exemple).</p>
<p>Désormais, lorsqu&rsquo;il y a plusieurs conteneurs dans un fichier <code>docker-compose.yml</code>, il y aura donc un fichier <code>.env</code> par conteneur. L&rsquo;appel de ce fichier se fait différemment, ce qui ne nécessite plus de lister les variables dans le fichier <code>docker-compose.yml</code>. Docker et Podman gèrent la liste des variables directement en lisant les fichiers <code>.env</code> comme des grands.</p>
<p>Cela se présente de la façon suivante (ajout de l&rsquo;entrée <code>env_file</code>) :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">mon-service</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">image</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">container_name</span>: <span style="color:#ae81ff">conteneur</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">hostname</span>: <span style="color:#ae81ff">conteneur</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">env_file</span>: <span style="color:#ae81ff">conteneur.env</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">/volume:/volume</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">1234</span>:<span style="color:#ae81ff">1234</span>
</span></span></code></pre></div><p>Je vous renvoie vers l&rsquo;article de la création d&rsquo;un serveur <a href="/posts/construire-son-cloud-avec-nextcloud/">Nextcloud</a> qui illustre bien ce changement.</p>
<h2 id="mode-restart">
  Mode restart
  <a href="#mode-restart" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>Lorsque l&rsquo;on arrête ou redémarre notre serveur, Docker conserve l&rsquo;état des conteneurs à l&rsquo;extinction. Le mode <code>unless-stopped</code> permet donc de ne pas relancer les conteneurs que l&rsquo;on avait manuellement arrêté sans les supprimer. Podman se comportant différemment, il considère que les conteneurs se sont correctement arrêtés et donc ne les relance pas au boot de la machine. Passer en mode <code>always</code> règle donc le souci. Attention cependant, vos conteneurs arrêtés manuellement seront relancés également.</p>
<p>A noter également que si vous voulez profiter de la mise à jour automatique, il est préférable de supprimer complètement la ligne <code>restart:</code>, et de passer par systemd pour le démarrage de vos conteneurs.</p>
<blockquote>
<p>Le script <a href="/posts/migration-de-docker-vers-podman/#jdockersh">jdocker.sh</a> est configuré pour fonctionner de cette façon.</p></blockquote>
<h2 id="nouveau-tag">
  Nouveau tag
  <a href="#nouveau-tag" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>Comme indiqué dans l&rsquo;article au sujet de la migration, un tag <a href="/tags/podman/">#podman</a> a été ajouté au site pour différencier les tutos à jour. Une première passe a déjà été faite, mais je vérifierai de nouveau au cas où une coquille se serait glissée quelque part.</p>
<h2 id="conclusion">
  Conclusion
  <a href="#conclusion" class="h-anchor" aria-hidden="true">#</a>
</h2>
<p>Vous pouvez désormais suivre les tutos de ce site, peu importe l&rsquo;application de conteneurisation que vous décidez d&rsquo;utiliser. Je n&rsquo;ai toutefois pas testé toutes les applications depuis ma migration, mais je serais surpris si un problème survenait. Dans ce cas, n&rsquo;hésitez pas à me le signaler par <a href="mailto:contact@jeremky.fr">e-mail</a>.</p>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h"
              >Autres posts</span
            >
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://www.jeremky.fr/posts/freshrss-un-agregateur-de-flux-rss/">
                  <span class="button__icon">←</span>
                  <span class="button__text">FreshRSS : un agrégateur de flux RSS</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="https://www.jeremky.fr/posts/migration-de-docker-vers-podman/">
                  <span class="button__text">Migration de Docker vers Podman</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    

    
      
        

      
    
  </article>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <a
  href="/"
  class="logo"
  style="text-decoration: none;"
>
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367" />
</svg>
</span>
    <span class="logo__text"
      >JEREMKY.FR</span
    >
    <span class="logo__cursor"></span>
  
</a>

      <div class="copyright">
          <div class="copyright">
        <span>© 2025 Propulsé par <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span>
      </div>
    
  </div>
</footer>





<script type="text/javascript" src="/bundle.min.js"></script>


      
    </div>

    
  </body>
</html>
